var keylength,cipher,primer,keyword,numSols,uInt8Array,workerNumber,totalWorkers,isRunning,solutions=[],runningKey=[];function decipherSequenceTrans(){"function"===typeof importScripts&&(importScripts("../support/decipherLib.js"),importScripts("../support/cryptoPrograms.js"));initSolution();createRunningKey();"undefined"!==typeof keyword&&(0<keyword.length?solveWithKeyword():solveSequenceTrans());!1===isRunning&&self.postMessage({cmd:"STOP",msg:""})}
function solveSequenceTrans(){var a,b,e;var c=[];var f=[],d=[],h=[];var l=0;isRunning=!0;initialiseCipherGrid(h);var q=0;a:for(;1E3>q;q+=1)if(isRunning){c=randomiseNumbers(10);for(b=0;b<c.length;b+=1)d[b]=c[b],f[b]=c[b];createCipherGrid(h,d);var g=decrypt(h,d);b=getTetraScore(g);b>l&&(l=b);solutions[numSols-1]<b&&(solutions[numSols-1]=b,solutions.sort(function(n,p){return p-n}),self.postMessage({cmd:"reslt",key:d.join(""),score:b,text:g}));for(e=15;1<e;--e)if(isRunning){var m=c=0;do{for(a=0;a<f.length;a+=
1)d[a]=f[a];a=Math.floor(10*Math.random());g=Math.floor(10*Math.random());var k=d[a];d[a]=d[g];d[g]=k;createCipherGrid(h,d);g=decrypt(h,d);a=getTetraScore(g);a>m&&(m=a,m>l&&(l=m));solutions[numSols-1]<a&&(solutions[numSols-1]=a,solutions.sort(function(n,p){return p-n}),self.postMessage({cmd:"reslt",key:d.join(""),score:a,text:g}));k=a-b;g=0;if(0<k)g=1;else{k=Math.pow(Math.E,k/e);var r=(1E3*Math.random()+1)/1E3;k>r&&(g=1)}if(1===g){for(b=0;b<d.length;b+=1)f[b]=d[b];b=a}c+=1}while(1E3>c&&isRunning)}else break a}else break a;
isRunning=!1}function solveWithKeyword(){var a=[];initialiseCipherGrid(a);createCipherGrid(a,keyword);var b=decrypt(a,keyword);a=getTetraScore(b);solutions[numSols-1]<a&&(solutions[numSols-1]=a,solutions.sort(function(e,c){return c-e}),self.postMessage({cmd:"reslt",key:keyword,score:a,text:b}));isRunning=!1}function decrypt(a,b){var e,c,f=[];for(c=0;c<b.length;c+=1)f[c]=1;var d="";for(e=0;e<cipher.length;e+=1){c=runningKey[e];var h=a[c][f[c]];d+=h;f[c]+=1}return d.toLowerCase()}
function initialiseCipherGrid(a){var b;keylength=10;for(b=0;b<keylength;b+=1)a[b]=[];for(b=0;b<keylength;b+=1)a[b][0]=0;for(b=0;b<runningKey.length;b+=1){var e=parseInt(runningKey[b]);a[e][0]+=1}}function createCipherGrid(a,b){var e,c,f;for(e=f=0;e<keylength;e+=1){var d=b[e];for(c=1;c<=a[d][0];c+=1){var h=cipher.charAt(f);a[d][c]=h;f+=1}}}
function createRunningKey(){var a,b=0;for(a=0;a<primer.length;a+=1)runningKey[a]=parseInt(primer.charAt(a));for(;a<cipher.length;)runningKey[a]=(runningKey[b]+runningKey[b+1])%10,b+=1,a+=1}self.addEventListener("message",function(a){a=a.data;cipher=a.cipher;uInt8Array=a.uInt8Array;totalWorkers=a.totalWorkers;workerNumber=a.workerNumber;numSols=a.numSols;primer=a.primer;keyword=a.keyword;decipherSequenceTrans()},!1);