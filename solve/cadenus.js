var cipher,uInt8Array,totalWorkers,workerNumber,numSols,keyword,isRunning,keyLength,solutions=[],cipherGrid=[];function decipherCadenus(){"function"===typeof importScripts&&(importScripts("../support/decipherLib.js"),importScripts("../support/cryptoPrograms.js"));initSolution();rearrangeCipher();"undefined"!==typeof keyword&&(0<keyword.length?solveWithKeyword(keyword):solveCadenus());!1===isRunning&&self.postMessage({cmd:"STOP",msg:""})}
function solveCadenus(){var a,b,d,l,n,g;var k=ord("A");var e=ord("Z");var f=[];var h=[];isRunning=!0;if(5>keyLength){for(a=0;6>a;a+=1)f[a]=a<keyLength?e:k;if(isRunning)a:for(a=k;a<=f[5];a+=1)for(h[5]=chr(a),b=k;b<=f[4];b+=1)for(h[4]=chr(b),d=k;d<=f[3];d+=1){if(!isRunning)break a;h[3]=chr(d);for(l=k;l<=f[2];l+=1)for(h[2]=chr(l),n=k;n<=f[1];n+=1)for(h[1]=chr(n),g=k;g<=f[0];g+=1){h[0]=chr(g);keyword=h.join("").substr(0,keyLength);var c=decrypt(keyword);e=getTetraScore(c);solutions[numSols-1]<e&&(solutions[numSols-
1]=e,solutions.sort(function(m,p){return p-m}),self.postMessage({cmd:"reslt",key:keyword,score:e,text:c}))}}}else for(b=englishAlph.replace("W",""),a=0;1E3>a;a+=1)if(isRunning)for(d=keyword=randomKey(),c=decrypt(keyword),f=getTetraScore(c),solutions[numSols-1]<f&&(solutions[numSols-1]=f,solutions.sort(function(m,p){return p-m}),self.postMessage({cmd:"reslt",key:keyword,score:f,text:c})),h=15;2<h;--h){if(isRunning){k=0;do g=Math.floor(Math.random()*b.length),g=b.substr(g,1),e=Math.floor(Math.random()*
keyLength),keyword=keyword.substr(0,e)+g+keyword.substr(e+1),c=decrypt(keyword),e=getTetraScore(c),solutions[numSols-1]<e&&(solutions[numSols-1]=e,solutions.sort(function(m,p){return p-m}),self.postMessage({cmd:"reslt",key:keyword,score:e,text:c})),c=e-f,g=0,0<c?g=1:(c=Math.pow(Math.E,c/h),l=(1E3*Math.random()+1)/1E3,c>l&&(g=1)),1===g&&(keyword=d,f=e),k+=1;while(1E3>k&&isRunning)}}else break;isRunning=!1}
function randomKey(){var a,b=englishAlph.replace("W","");var d=b.substr(Math.floor(Math.random()*b.length),1);for(a=1;a<keyLength;a+=1)d+=b.substr(Math.floor(Math.random()*b.length),1);return d}function solveWithKeyword(){var a=decrypt(keyword);var b=getTetraScore(a);solutions[numSols-1]<b&&(solutions[numSols-1]=b,solutions.sort(function(d,l){return l-d}),self.postMessage({cmd:"reslt",key:keyword,score:b,text:a}));isRunning=!1}
function decrypt(a){var b,d,l=ord("A"),n=ord("Z"),g=[],k=[],e=[],f=[];var h="";keyLength=a.length;for(b=0;b<keyLength;b+=1)f[b]=[];var c=0;for(b=l;b<=n;b+=1){var m=chr(b);for(d=a.indexOf(m);0<=d&&c<keyLength;)k[c]=m,e[c]=m,c+=1,d=a.indexOf(m,d+1)}for(b=0;b<keyLength;b+=1)d=e.indexOf(a.charAt(b)),g[b]=d,e[d]=" ";for(b=0;b<keyLength;b+=1){d=ord(k[b])-l;21<d&&--d;a=0;for(c=d;25>c;c+=1)f[b][a]=cipherGrid[b][c],a+=1;if(0<d)for(c=0;c<d;c+=1)f[b][a]=cipherGrid[b][c],a+=1}for(b=0;25>b;b+=1)for(c=0;c<keyLength;c+=
1)h+=f[g[c]][b];return h.toLowerCase()}function rearrangeCipher(){var a,b,d=0;keyLength=Math.floor(cipher.length/25);cipherGrid=[];for(a=0;25>a;a+=1)cipherGrid[a]=[];for(a=0;25>a;a+=1)for(b=0;b<keyLength;b+=1)cipherGrid[b][a]=cipher.charAt(d),d+=1}self.addEventListener("message",function(a){a=a.data;cipher=a.cipher;uInt8Array=a.uInt8Array;totalWorkers=a.totalWorkers;workerNumber=a.workerNumber;numSols=a.numSols;keyword=a.keyword;decipherCadenus()},!1);